What is task.event? It looks like it just holds the blocking semaphore.
Now that I have a blocking queue do I still need it?

What is semaphore state?